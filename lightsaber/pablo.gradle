apply plugin: 'io.michaelrocks.pablo'

def shadowEnabled = project.providers.gradleProperty("pablo.shadow.enabled").map { it.toBoolean() }
configurations.getByName("relocate") { relocateConfiguration ->
  if (shadowEnabled.get()) {
    return
  }

  configurations.getByName(JavaPlugin.IMPLEMENTATION_CONFIGURATION_NAME).extendsFrom(relocateConfiguration)
  configurations.getByName(JavaPlugin.TEST_IMPLEMENTATION_CONFIGURATION_NAME).extendsFrom(relocateConfiguration)
}

pablo {
  pom {
    name = 'Lightsaber'
    description = 'Compile time dependency injection framework for JVM languages.'
    inceptionYear = '2015'
    url = 'https://github.com/joomcode/lightsaber'

    licenses {
      license {
        name = 'The Apache License, Version 2.0'
        url = 'http://www.apache.org/licenses/LICENSE-2.0.txt'
        distribution = 'repo'
      }
    }
    organization {
      name = 'Joom'
      url = 'https://joom.com'
    }
    developers {
      developer {
        id = 'MichaelRocks'
        name = 'Michael Rozumyanskiy'
        email = 'michael.rozumyanskiy@gmail.com'
      }
    }
    scm {
      connection = 'scm:git:git://github.com/joomcode/lightsaber.git'
      developerConnection = 'scm:git:ssh://git@github.com/joomcode/lightsaber.git'
      url = 'https://github.com/joomcode/lightsaber'
    }
  }

  signing {
    enabled.set(providers.gradleProperty("development").map { !it.toBoolean() })
  }
}
